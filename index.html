<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sikorski Logic | Rant-to-Prompt v2</title>
    <style>
        :root { --bg: #0b0f1a; --card: #161b22; --accent: #00d4ff; --text: #e6edf3; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); padding: 2rem; max-width: 900px; margin: auto; }
        .dashboard { background: var(--card); border: 1px solid #30363d; border-radius: 12px; padding: 2rem; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1 { color: var(--accent); margin-top: 0; font-weight: 300; letter-spacing: 1px; }
        textarea { width: 100%; height: 180px; background: #0d1117; color: #c9d1d9; border: 1px solid #30363d; border-radius: 8px; padding: 15px; font-size: 1rem; margin-bottom: 1.5rem; resize: vertical; box-sizing: border-box; }
        .controls { display: flex; gap: 15px; margin-bottom: 1.5rem; }
        button { padding: 12px 24px; border-radius: 6px; border: none; cursor: pointer; font-weight: bold; transition: all 0.2s; }
        .btn-start { background: var(--accent); color: #0b0f1a; }
        .btn-start.recording { background: #ff4d4d; animation: pulse 1.5s infinite; }
        .btn-copy { background: #238636; color: white; }
        .btn-copy:hover { background: #2ea043; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
        .status-bar { font-size: 0.85rem; color: #8b949e; margin-bottom: 1rem; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

<div class="dashboard">
    <h1>üéôÔ∏è Sikorski Rant-to-Prompt</h1>
    <div class="status-bar">
        <span id="status">Status: System Ready</span>
        <span id="mic-level">Signal: 0%</span>
    </div>

    <label>Raw Engineering Rant:</label>
    <textarea id="rawText" placeholder="Start speaking... I will capture every thought on humanoid robotics, energy storage, or ASICs."></textarea>

    <div class="controls">
        <button class="btn-start" id="toggleBtn">Start Recording</button>
        <button class="btn-copy" id="copyBtn">Copy Optimized Prompt</button>
    </div>

    <label>Live Optimized Prompt (Multi-Agent Structured):</label>
    <textarea id="finalPrompt" readonly placeholder="The structured prompt will appear here in real-time..."></textarea>
</div>

<script>
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    
    if (!SpeechRecognition) {
        alert("Your browser does not support Speech Recognition. Please use Chrome or Edge.");
    }

    const recognition = new SpeechRecognition();
    recognition.continuous = true;
    recognition.interimResults = true;
    recognition.lang = 'en-US';

    const rawTextArea = document.getElementById('rawText');
    const finalPromptArea = document.getElementById('finalPrompt');
    const toggleBtn = document.getElementById('toggleBtn');
    const statusText = document.getElementById('status');

    let isRecording = false;

    // Logic to build the prompt dynamically
    function updateOptimizedPrompt(text) {
        if (!text.trim()) return "";
        const header = "### TASK: RESTRUCTURE ENGINEERING RANT\n";
        const context = "### RAW INPUT:\n" + text + "\n\n";
        const instruction = "### INSTRUCTIONS:\n1. Extract core technical goals.\n2. Identify hardware/software dependencies (Voron/Humanoid/FOSS).\n3. Reformat as a clean, agentic instruction set for a high-level LLM.";
        return header + context + instruction;
    }

    recognition.onstart = () => {
        statusText.innerText = "Status: Listening / Secure Connection Active";
        toggleBtn.classList.add('recording');
        toggleBtn.innerText = "Stop Recording";
    };

    recognition.onerror = (event) => {
        statusText.innerText = "Error: " + event.error;
        if(event.error === 'not-allowed') alert("Check Chrome settings: Allow microphone access for local files or host on GitHub Pages.");
    };

    recognition.onresult = (event) => {
        let currentTranscript = "";
        for (let i = 0; i < event.results.length; i++) {
            currentTranscript += event.results[i][0].transcript;
        }
        
        // Update the RAW box
        rawTextArea.value = currentTranscript;
        
        // Update the PREVIEW box LIVE
        finalPromptArea.value = updateOptimizedPrompt(currentTranscript);
    };

    toggleBtn.onclick = () => {
        if (isRecording) {
            recognition.stop();
            isRecording = false;
            toggleBtn.classList.remove('recording');
            toggleBtn.innerText = "Start Recording";
        } else {
            recognition.start();
            isRecording = true;
        }
    };

    document.getElementById('copyBtn').onclick = () => {
        if (!finalPromptArea.value) {
            alert("Nothing to copy yet! Start speaking first.");
            return;
        }
        finalPromptArea.select();
        document.execCommand('copy');
        statusText.innerText = "Status: Prompt Copied to Clipboard!";
    };
</script>

</body>
</html>